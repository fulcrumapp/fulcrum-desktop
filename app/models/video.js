"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _minidb = require("minidb");

var _fulcrumCore = require("fulcrum-core");

class Video {
  static get tableName() {
    return 'videos';
  }

  static get columns() {
    return [{
      name: 'accountRowID',
      column: 'account_id',
      type: 'integer',
      null: false
    }, {
      name: 'id',
      column: 'resource_id',
      type: 'string',
      null: false
    }, {
      name: 'metadata',
      column: 'metadata',
      type: 'json'
    }, {
      name: 'filePath',
      column: 'file_path',
      type: 'string'
    }, {
      name: 'fileSize',
      column: 'file_size',
      type: 'integer'
    }, {
      name: 'contentType',
      column: 'content_type',
      type: 'string'
    }, {
      name: 'isDownloaded',
      column: 'is_downloaded',
      type: 'boolean',
      null: false
    }, {
      name: 'isUploaded',
      column: 'is_uploaded',
      type: 'boolean',
      null: false
    }, {
      name: 'isStored',
      column: 'is_stored',
      type: 'boolean',
      null: false
    }, {
      name: 'isProcessed',
      column: 'is_processed',
      type: 'boolean',
      null: false
    }, {
      name: 'formRowID',
      column: 'form_id',
      type: 'integer'
    }, {
      name: 'formID',
      column: 'form_resource_id',
      type: 'string'
    }, {
      name: 'recordRowID',
      column: 'record_id',
      type: 'integer'
    }, {
      name: 'recordID',
      column: 'record_resource_id',
      type: 'string'
    }, {
      name: 'updatedByRowID',
      column: 'updated_by_id',
      type: 'integer'
    }, {
      name: 'updatedByID',
      column: 'updated_by_resource_id',
      type: 'string'
    }, {
      name: 'createdByRowID',
      column: 'created_by_id',
      type: 'integer'
    }, {
      name: 'createdByID',
      column: 'created_by_resource_id',
      type: 'string'
    }, {
      name: 'hasTrack',
      column: 'has_track',
      type: 'boolean'
    }, {
      name: 'trackJSON',
      column: 'track',
      type: 'json'
    }, {
      name: 'width',
      column: 'width',
      type: 'integer'
    }, {
      name: 'height',
      column: 'height',
      type: 'integer'
    }, {
      name: 'duration',
      column: 'duration',
      type: 'double'
    }, {
      name: 'bitRate',
      column: 'bit_rate',
      type: 'double'
    }, {
      name: 'createdAt',
      column: 'server_created_at',
      type: 'datetime'
    }, {
      name: 'updatedAt',
      column: 'server_updated_at',
      type: 'datetime'
    }];
  }

  get id() {
    return this._id;
  }

  updateFromAPIAttributes(attributes) {
    this._id = attributes.access_key;
    this._metadata = attributes.metadata;
    this._fileSize = attributes.file_size;
    this._isUploaded = attributes.uploaded;
    this._isStored = attributes.stored;
    this._isProcessed = attributes.processed;
    this._contentType = attributes.content_type;
    this._hasTrack = !!attributes.track;
    this._trackJSON = attributes.track;
    this._createdByID = attributes.created_by_id;
    this._updatedByID = attributes.updated_by_id;
    this._createdAt = _fulcrumCore.DateUtils.parseISOTimestamp(attributes.created_at);
    this._updatedAt = _fulcrumCore.DateUtils.parseISOTimestamp(attributes.updated_at);
    this._formID = attributes.form_id;
    this._recordID = attributes.record_id;
    this._width = null;
    this._height = null;
    this._bitRate = null;

    if (attributes.metadata) {
      const video = attributes.metadata && attributes.metadata.streams && attributes.metadata.streams.find(s => s.codec_type === 'video');

      if (video) {
        this._width = video.width;
        this._height = video.height;
      }

      if (attributes.metadata && attributes.metadata.format) {
        if (attributes.metadata.format.duration != null) {
          this._duration = +attributes.metadata.format.duration;
        }

        if (attributes.metadata.format.bit_rate != null) {
          this._bitRate = +attributes.metadata.format.bit_rate;
        }
      }
    }
  }

  get isDownloaded() {
    return this._isDownloaded;
  }

  set isDownloaded(value) {
    this._isDownloaded = !!value;
  }

  get createdAt() {
    return this._createdAt;
  }

  get updatedAt() {
    return this._updatedAt;
  }

}

exports.default = Video;

_minidb.PersistentObject.register(Video);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tb2RlbHMvdmlkZW8uanMiXSwibmFtZXMiOlsiVmlkZW8iLCJ0YWJsZU5hbWUiLCJjb2x1bW5zIiwibmFtZSIsImNvbHVtbiIsInR5cGUiLCJudWxsIiwiaWQiLCJfaWQiLCJ1cGRhdGVGcm9tQVBJQXR0cmlidXRlcyIsImF0dHJpYnV0ZXMiLCJhY2Nlc3Nfa2V5IiwiX21ldGFkYXRhIiwibWV0YWRhdGEiLCJfZmlsZVNpemUiLCJmaWxlX3NpemUiLCJfaXNVcGxvYWRlZCIsInVwbG9hZGVkIiwiX2lzU3RvcmVkIiwic3RvcmVkIiwiX2lzUHJvY2Vzc2VkIiwicHJvY2Vzc2VkIiwiX2NvbnRlbnRUeXBlIiwiY29udGVudF90eXBlIiwiX2hhc1RyYWNrIiwidHJhY2siLCJfdHJhY2tKU09OIiwiX2NyZWF0ZWRCeUlEIiwiY3JlYXRlZF9ieV9pZCIsIl91cGRhdGVkQnlJRCIsInVwZGF0ZWRfYnlfaWQiLCJfY3JlYXRlZEF0IiwiRGF0ZVV0aWxzIiwicGFyc2VJU09UaW1lc3RhbXAiLCJjcmVhdGVkX2F0IiwiX3VwZGF0ZWRBdCIsInVwZGF0ZWRfYXQiLCJfZm9ybUlEIiwiZm9ybV9pZCIsIl9yZWNvcmRJRCIsInJlY29yZF9pZCIsIl93aWR0aCIsIl9oZWlnaHQiLCJfYml0UmF0ZSIsInZpZGVvIiwic3RyZWFtcyIsImZpbmQiLCJzIiwiY29kZWNfdHlwZSIsIndpZHRoIiwiaGVpZ2h0IiwiZm9ybWF0IiwiZHVyYXRpb24iLCJfZHVyYXRpb24iLCJiaXRfcmF0ZSIsImlzRG93bmxvYWRlZCIsIl9pc0Rvd25sb2FkZWQiLCJ2YWx1ZSIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsIlBlcnNpc3RlbnRPYmplY3QiLCJyZWdpc3RlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUVlLE1BQU1BLEtBQU4sQ0FBWTtBQUNMLGFBQVRDLFNBQVMsR0FBRztBQUNyQixXQUFPLFFBQVA7QUFDRDs7QUFFaUIsYUFBUEMsT0FBTyxHQUFH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UUFBakIsQ0FBMEI3RCxLQUExQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBlcnNpc3RlbnRPYmplY3QgfSBmcm9tICdtaW5pZGInO1xuaW1wb3J0IHsgRGF0ZVV0aWxzIH0gZnJvbSAnZnVsY3J1bS1jb3JlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlkZW8ge1xuICBzdGF0aWMgZ2V0IHRhYmxlTmFtZSgpIHtcbiAgICByZXR1cm4gJ3ZpZGVvcyc7XG4gIH1cblxuICBzdGF0aWMgZ2V0IGNvbHVtbnMoKSB7XG4gICAgcmV0dXJuIFtcbiAgICAgIHsgbmFtZTogJ2FjY291bnRSb3dJRCcsIGNvbHVtbjogJ2FjY291bnRfaWQnLCB0eXBlOiAnaW50ZWdlcicsIG51bGw6IGZhbHNlIH0sXG4gICAgICB7IG5hbWU6ICdpZCcsIGNvbHVtbjogJ3Jlc291cmNlX2lkJywgdHlwZTogJ3N0cmluZycsIG51bGw6IGZhbHNlIH0sXG4gICAgICB7IG5hbWU6ICdtZXRhZGF0YScsIGNvbHVtbjogJ21ldGFkYXRhJywgdHlwZTogJ2pzb24nIH0sXG4gICAgICB7IG5hbWU6ICdmaWxlUGF0aCcsIGNvbHVtbjogJ2ZpbGVfcGF0aCcsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB7IG5hbWU6ICdmaWxlU2l6ZScsIGNvbHVtbjogJ2ZpbGVfc2l6ZScsIHR5cGU6ICdpbnRlZ2VyJyB9LFxuICAgICAgeyBuYW1lOiAnY29udGVudFR5cGUnLCBjb2x1bW46ICdjb250ZW50X3R5cGUnLCB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgeyBuYW1lOiAnaXNEb3dubG9hZGVkJywgY29sdW1uOiAnaXNfZG93bmxvYWRlZCcsIHR5cGU6ICdib29sZWFuJywgbnVsbDogZmFsc2UgfSxcbiAgICAgIHsgbmFtZTogJ2lzVXBsb2FkZWQnLCBjb2x1bW46ICdpc191cGxvYWRlZCcsIHR5cGU6ICdib29sZWFuJywgbnVsbDogZmFsc2UgfSxcbiAgICAgIHsgbmFtZTogJ2lzU3RvcmVkJywgY29sdW1uOiAnaXNfc3RvcmVkJywgdHlwZTogJ2Jvb2xlYW4nLCBudWxsOiBmYWxzZSB9LFxuICAgICAgeyBuYW1lOiAnaXNQcm9jZXNzZWQnLCBjb2x1bW46ICdpc19wcm9jZXNzZWQnLCB0eXBlOiAnYm9vbGVhbicsIG51bGw6IGZhbHNlIH0sXG4gICAgICB7IG5hbWU6ICdmb3JtUm93SUQnLCBjb2x1bW46ICdmb3JtX2lkJywgdHlwZTogJ2ludGVnZXInIH0sXG4gICAgICB7IG5hbWU6ICdmb3JtSUQnLCBjb2x1bW46ICdmb3JtX3Jlc291cmNlX2lkJywgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgIHsgbmFtZTogJ3JlY29yZFJvd0lEJywgY29sdW1uOiAncmVjb3JkX2lkJywgdHlwZTogJ2ludGVnZXInIH0sXG4gICAgICB7IG5hbWU6ICdyZWNvcmRJRCcsIGNvbHVtbjogJ3JlY29yZF9yZXNvdXJjZV9pZCcsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB7IG5hbWU6ICd1cGRhdGVkQnlSb3dJRCcsIGNvbHVtbjogJ3VwZGF0ZWRfYnlfaWQnLCB0eXBlOiAnaW50ZWdlcicgfSxcbiAgICAgIHsgbmFtZTogJ3VwZGF0ZWRCeUlEJywgY29sdW1uOiAndXBkYXRlZF9ieV9yZXNvdXJjZV9pZCcsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB7IG5hbWU6ICdjcmVhdGVkQnlSb3dJRCcsIGNvbHVtbjogJ2NyZWF0ZWRfYnlfaWQnLCB0eXBlOiAnaW50ZWdlcicgfSxcbiAgICAgIHsgbmFtZTogJ2NyZWF0ZWRCeUlEJywgY29sdW1uOiAnY3JlYXRlZF9ieV9yZXNvdXJjZV9pZCcsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB7IG5hbWU6ICdoYXNUcmFjaycsIGNvbHVtbjogJ2hhc190cmFjaycsIHR5cGU6ICdib29sZWFuJyB9LFxuICAgICAgeyBuYW1lOiAndHJhY2tKU09OJywgY29sdW1uOiAndHJhY2snLCB0eXBlOiAnanNvbicgfSxcbiAgICAgIHsgbmFtZTogJ3dpZHRoJywgY29sdW1uOiAnd2lkdGgnLCB0eXBlOiAnaW50ZWdlcicgfSxcbiAgICAgIHsgbmFtZTogJ2hlaWdodCcsIGNvbHVtbjogJ2hlaWdodCcsIHR5cGU6ICdpbnRlZ2VyJyB9LFxuICAgICAgeyBuYW1lOiAnZHVyYXRpb24nLCBjb2x1bW46ICdkdXJhdGlvbicsIHR5cGU6ICdkb3VibGUnIH0sXG4gICAgICB7IG5hbWU6ICdiaXRSYXRlJywgY29sdW1uOiAnYml0X3JhdGUnLCB0eXBlOiAnZG91YmxlJyB9LFxuICAgICAgeyBuYW1lOiAnY3JlYXRlZEF0JywgY29sdW1uOiAnc2VydmVyX2NyZWF0ZWRfYXQnLCB0eXBlOiAnZGF0ZXRpbWUnIH0sXG4gICAgICB7IG5hbWU6ICd1cGRhdGVkQXQnLCBjb2x1bW46ICdzZXJ2ZXJfdXBkYXRlZF9hdCcsIHR5cGU6ICdkYXRldGltZScgfVxuICAgIF07XG4gIH1cblxuICBnZXQgaWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG5cbiAgdXBkYXRlRnJvbUFQSUF0dHJpYnV0ZXMoYXR0cmlidXRlcykge1xuICAgIHRoaXMuX2lkID0gYXR0cmlidXRlcy5hY2Nlc3Nfa2V5O1xuICAgIHRoaXMuX21ldGFkYXRhID0gYXR0cmlidXRlcy5tZXRhZGF0YTtcbiAgICB0aGlzLl9maWxlU2l6ZSA9IGF0dHJpYnV0ZXMuZmlsZV9zaXplO1xuICAgIHRoaXMuX2lzVXBsb2FkZWQgPSBhdHRyaWJ1dGVzLnVwbG9hZGVkO1xuICAgIHRoaXMuX2lzU3RvcmVkID0gYXR0cmlidXRlcy5zdG9yZWQ7XG4gICAgdGhpcy5faXNQcm9jZXNzZWQgPSBhdHRyaWJ1dGVzLnByb2Nlc3NlZDtcbiAgICB0aGlzLl9jb250ZW50VHlwZSA9IGF0dHJpYnV0ZXMuY29udGVudF90eXBlO1xuICAgIHRoaXMuX2hhc1RyYWNrID0gISFhdHRyaWJ1dGVzLnRyYWNrO1xuICAgIHRoaXMuX3RyYWNrSlNPTiA9IGF0dHJpYnV0ZXMudHJhY2s7XG4gICAgdGhpcy5fY3JlYXRlZEJ5SUQgPSBhdHRyaWJ1dGVzLmNyZWF0ZWRfYnlfaWQ7XG4gICAgdGhpcy5fdXBkYXRlZEJ5SUQgPSBhdHRyaWJ1dGVzLnVwZGF0ZWRfYnlfaWQ7XG4gICAgdGhpcy5fY3JlYXRlZEF0ID0gRGF0ZVV0aWxzLnBhcnNlSVNPVGltZXN0YW1wKGF0dHJpYnV0ZXMuY3JlYXRlZF9hdCk7XG4gICAgdGhpcy5fdXBkYXRlZEF0ID0gRGF0ZVV0aWxzLnBhcnNlSVNPVGltZXN0YW1wKGF0dHJpYnV0ZXMudXBkYXRlZF9hdCk7XG4gICAgdGhpcy5fZm9ybUlEID0gYXR0cmlidXRlcy5mb3JtX2lkO1xuICAgIHRoaXMuX3JlY29yZElEID0gYXR0cmlidXRlcy5yZWNvcmRfaWQ7XG5cbiAgICB0aGlzLl93aWR0aCA9IG51bGw7XG4gICAgdGhpcy5faGVpZ2h0ID0gbnVsbDtcbiAgICB0aGlzLl9iaXRSYXRlID0gbnVsbDtcblxuICAgIGlmIChhdHRyaWJ1dGVzLm1ldGFkYXRhKSB7XG4gICAgICBjb25zdCB2aWRlbyA9IGF0dHJpYnV0ZXMubWV0YWRhdGEgJiYgYXR0cmlidXRlcy5tZXRhZGF0YS5zdHJlYW1zICYmIGF0dHJpYnV0ZXMubWV0YWRhdGEuc3RyZWFtcy5maW5kKHMgPT4gcy5jb2RlY190eXBlID09PSAndmlkZW8nKTtcblxuICAgICAgaWYgKHZpZGVvKSB7XG4gICAgICAgIHRoaXMuX3dpZHRoID0gdmlkZW8ud2lkdGg7XG4gICAgICAgIHRoaXMuX2hlaWdodCA9IHZpZGVvLmhlaWdodDtcbiAgICAgIH1cblxuICAgICAgaWYgKGF0dHJpYnV0ZXMubWV0YWRhdGEgJiYgYXR0cmlidXRlcy5tZXRhZGF0YS5mb3JtYXQpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMubWV0YWRhdGEuZm9ybWF0LmR1cmF0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICB0aGlzLl9kdXJhdGlvbiA9ICthdHRyaWJ1dGVzLm1ldGFkYXRhLmZvcm1hdC5kdXJhdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhdHRyaWJ1dGVzLm1ldGFkYXRhLmZvcm1hdC5iaXRfcmF0ZSAhPSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5fYml0UmF0ZSA9ICthdHRyaWJ1dGVzLm1ldGFkYXRhLmZvcm1hdC5iaXRfcmF0ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldCBpc0Rvd25sb2FkZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzRG93bmxvYWRlZDtcbiAgfVxuXG4gIHNldCBpc0Rvd25sb2FkZWQodmFsdWUpIHtcbiAgICB0aGlzLl9pc0Rvd25sb2FkZWQgPSAhIXZhbHVlO1xuICB9XG5cbiAgZ2V0IGNyZWF0ZWRBdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fY3JlYXRlZEF0O1xuICB9XG5cbiAgZ2V0IHVwZGF0ZWRBdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdXBkYXRlZEF0O1xuICB9XG59XG5cblBlcnNpc3RlbnRPYmplY3QucmVnaXN0ZXIoVmlkZW8pO1xuIl19