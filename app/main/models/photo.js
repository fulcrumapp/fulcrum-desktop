"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _minidb = require("minidb");

var _fulcrumCore = require("fulcrum-core");

class Photo {
  static get tableName() {
    return 'photos';
  }

  static get columns() {
    return [{
      name: 'accountRowID',
      column: 'account_id',
      type: 'integer',
      null: false
    }, {
      name: 'id',
      column: 'resource_id',
      type: 'string',
      null: false
    }, {
      name: 'exif',
      column: 'exif',
      type: 'json'
    }, {
      name: 'filePath',
      column: 'file_path',
      type: 'string'
    }, {
      name: 'fileSize',
      column: 'file_size',
      type: 'integer'
    }, {
      name: 'contentType',
      column: 'content_type',
      type: 'string'
    }, {
      name: 'isDownloaded',
      column: 'is_downloaded',
      type: 'boolean',
      null: false
    }, {
      name: 'isUploaded',
      column: 'is_uploaded',
      type: 'boolean',
      null: false
    }, {
      name: 'isStored',
      column: 'is_stored',
      type: 'boolean',
      null: false
    }, {
      name: 'isProcessed',
      column: 'is_processed',
      type: 'boolean',
      null: false
    }, {
      name: 'latitude',
      column: 'latitude',
      type: 'double'
    }, {
      name: 'longitude',
      column: 'longitude',
      type: 'double'
    }, {
      name: 'formRowID',
      column: 'form_id',
      type: 'integer'
    }, {
      name: 'formID',
      column: 'form_resource_id',
      type: 'string'
    }, {
      name: 'recordRowID',
      column: 'record_id',
      type: 'integer'
    }, {
      name: 'recordID',
      column: 'record_resource_id',
      type: 'string'
    }, {
      name: 'updatedByRowID',
      column: 'updated_by_id',
      type: 'integer'
    }, {
      name: 'updatedByID',
      column: 'updated_by_resource_id',
      type: 'string'
    }, {
      name: 'createdByRowID',
      column: 'created_by_id',
      type: 'integer'
    }, {
      name: 'createdByID',
      column: 'created_by_resource_id',
      type: 'string'
    }, {
      name: 'altitude',
      column: 'altitude',
      type: 'double'
    }, {
      name: 'accuracy',
      column: 'accuracy',
      type: 'double'
    }, {
      name: 'direction',
      column: 'direction',
      type: 'double'
    }, {
      name: 'width',
      column: 'width',
      type: 'integer'
    }, {
      name: 'height',
      column: 'height',
      type: 'integer'
    }, {
      name: 'make',
      column: 'make',
      type: 'string'
    }, {
      name: 'model',
      column: 'model',
      type: 'string'
    }, {
      name: 'software',
      column: 'software',
      type: 'string'
    }, {
      name: 'dateTime',
      column: 'date_time',
      type: 'string'
    }, {
      name: 'createdAt',
      column: 'server_created_at',
      type: 'datetime'
    }, {
      name: 'updatedAt',
      column: 'server_updated_at',
      type: 'datetime'
    }];
  }

  get id() {
    return this._id;
  }

  integerValue(value) {
    return Array.isArray(value) ? value[0] : value;
  }

  updateFromAPIAttributes(attributes) {
    this._id = attributes.access_key;
    this._exif = attributes.exif;
    this._fileSize = attributes.file_size;
    this._latitude = attributes.latitude;
    this._longitude = attributes.longitude;
    this._isUploaded = attributes.uploaded;
    this._isStored = attributes.stored;
    this._isProcessed = attributes.processed;
    this._contentType = attributes.content_type;
    this._createdByID = attributes.created_by_id;
    this._updatedByID = attributes.updated_by_id;
    this._createdAt = _fulcrumCore.DateUtils.parseISOTimestamp(attributes.created_at);
    this._updatedAt = _fulcrumCore.DateUtils.parseISOTimestamp(attributes.updated_at);
    this._formID = attributes.form_id;
    this._recordID = attributes.record_id;

    if (attributes.exif) {
      const {
        exif
      } = attributes;
      this._altitude = exif.gps_altitude;
      this._direction = exif.gps_img_direction;
      this._accuracy = exif.gps_dop;
      this._width = this.integerValue(exif.pixel_x_dimension);
      this._height = this.integerValue(exif.pixel_y_dimension);
      this._make = exif.make;
      this._model = exif.model;
      this._software = exif.software;
      this._dateTime = exif.date_time_original || exif.date_time;
    }
  }

  get isDownloaded() {
    return this._isDownloaded;
  }

  set isDownloaded(value) {
    this._isDownloaded = !!value;
  }

  get createdAt() {
    return this._createdAt;
  }

  get updatedAt() {
    return this._updatedAt;
  }

}

exports.default = Photo;

_minidb.PersistentObject.register(Photo);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9tYWluL21vZGVscy9waG90by5qcyJdLCJuYW1lcyI6WyJQaG90byIsInRhYmxlTmFtZSIsImNvbHVtbnMiLCJuYW1lIiwiY29sdW1uIiwidHlwZSIsIm51bGwiLCJpZCIsIl9pZCIsImludGVnZXJWYWx1ZSIsInZhbHVlIiwiQXJyYXkiLCJpc0FycmF5IiwidXBkYXRlRnJvbUFQSUF0dHJpYnV0ZXMiLCJhdHRyaWJ1dGVzIiwiYWNjZXNzX2tleSIsIl9leGlmIiwiZXhpZiIsIl9maWxlU2l6ZSIsImZpbGVfc2l6ZSIsIl9sYXRpdHVkZSIsImxhdGl0dWRlIiwiX2xvbmdpdHVkZSIsImxvbmdpdHVkZSIsIl9pc1VwbG9hZGVkIiwidXBsb2FkZWQiLCJfaXNTdG9yZWQiLCJzdG9yZWQiLCJfaXNQcm9jZXNzZWQiLCJwcm9jZXNzZWQiLCJfY29udGVudFR5cGUiLCJjb250ZW50X3R5cGUiLCJfY3JlYXRlZEJ5SUQiLCJjcmVhdGVkX2J5X2lkIiwiX3VwZGF0ZWRCeUlEIiwidXBkYXRlZF9ieV9pZCIsIl9jcmVhdGVkQXQiLCJEYXRlVXRpbHMiLCJwYXJzZUlTT1RpbWVzdGFtcCIsImNyZWF0ZWRfYXQiLCJfdXBkYXRlZEF0IiwidXBkYXRlZF9hdCIsIl9mb3JtSUQiLCJmb3JtX2lkIiwiX3JlY29yZElEIiwicmVjb3JkX2lkIiwiX2FsdGl0dWRlIiwiZ3BzX2FsdGl0dWRlIiwiX2RpcmVjdGlvbiIsImdwc19pbWdfZGlyZWN0aW9uIiwiX2FjY3VyYWN5IiwiZ3BzX2RvcCIsIl93aWR0aCIsInBpeGVsX3hfZGltZW5zaW9uIiwiX2hlaWdodCIsInBpeGVsX3lfZGltZW5zaW9uIiwiX21ha2UiLCJtYWtlIiwiX21vZGVsIiwibW9kZWwiLCJfc29mdHdhcmUiLCJzb2Z0d2FyZSIsIl9kYXRlVGltZSIsImRhdGVfdGltZV9vcmlnaW5hbCIsImRhdGVfdGltZSIsImlzRG93bmxvYWRlZCIsIl9pc0Rvd25sb2FkZWQiLCJjcmVhdGVkQXQiLCJ1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QUFMLENBQWtCUSxJQUFJLENBQUNzQyxpQkFBdkIsQ0FBZjtBQUNBLFdBQUtDLEtBQUwsR0FBYXZDLElBQUksQ0FBQ3dDLElBQWxCO0FBQ0EsV0FBS0MsTUFBTCxHQUFjekMsSUFBSSxDQUFDMEMsS0FBbkI7QUFDQSxXQUFLQyxTQUFMLEdBQWlCM0MsSUFBSSxDQUFDNEMsUUFBdEI7QUFDQSxXQUFLQyxTQUFMLEdBQWlCN0MsSUFBSSxDQUFDOEMsa0JBQUwsSUFBMkI5QyxJQUFJLENBQUMrQyxTQUFqRDtBQUNEO0FBQ0Y7O0FBRWUsTUFBWkMsWUFBWSxHQUFHO0FBQ2pCLFdBQU8sS0FBS0MsYUFBWjtBQUNEOztBQUVlLE1BQVpELFlBQVksQ0FBQ3ZELEtBQUQsRUFBUTtBQUN0QixTQUFLd0QsYUFBTCxHQUFxQixDQUFDLENBQUN4RCxLQUF2QjtBQUNEOztBQUVZLE1BQVR5RCxTQUFTLEdBQUc7QUFDZCxXQUFPLEtBQUsvQixVQUFaO0FBQ0Q7O0FBRVksTUFBVGdDLFNBQVMsR0FBRztBQUNkLFdBQU8sS0FBSzVCLFVBQVo7QUFDRDs7QUEvRndCOzs7O0FBa0czQjZCLHlCQUFpQkMsUUFBakIsQ0FBMEJ0RSxLQUExQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBlcnNpc3RlbnRPYmplY3QgfSBmcm9tICdtaW5pZGInO1xuaW1wb3J0IHsgRGF0ZVV0aWxzIH0gZnJvbSAnZnVsY3J1bS1jb3JlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGhvdG8ge1xuICBzdGF0aWMgZ2V0IHRhYmxlTmFtZSgpIHtcbiAgICByZXR1cm4gJ3Bob3Rvcyc7XG4gIH1cblxuICBzdGF0aWMgZ2V0IGNvbHVtbnMoKSB7XG4gICAgcmV0dXJuIFtcbiAgICAgIHsgbmFtZTogJ2FjY291bnRSb3dJRCcsIGNvbHVtbjogJ2FjY291bnRfaWQnLCB0eXBlOiAnaW50ZWdlcicsIG51bGw6IGZhbHNlIH0sXG4gICAgICB7IG5hbWU6ICdpZCcsIGNvbHVtbjogJ3Jlc291cmNlX2lkJywgdHlwZTogJ3N0cmluZycsIG51bGw6IGZhbHNlIH0sXG4gICAgICB7IG5hbWU6ICdleGlmJywgY29sdW1uOiAnZXhpZicsIHR5cGU6ICdqc29uJyB9LFxuICAgICAgeyBuYW1lOiAnZmlsZVBhdGgnLCBjb2x1bW46ICdmaWxlX3BhdGgnLCB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgeyBuYW1lOiAnZmlsZVNpemUnLCBjb2x1bW46ICdmaWxlX3NpemUnLCB0eXBlOiAnaW50ZWdlcicgfSxcbiAgICAgIHsgbmFtZTogJ2NvbnRlbnRUeXBlJywgY29sdW1uOiAnY29udGVudF90eXBlJywgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgIHsgbmFtZTogJ2lzRG93bmxvYWRlZCcsIGNvbHVtbjogJ2lzX2Rvd25sb2FkZWQnLCB0eXBlOiAnYm9vbGVhbicsIG51bGw6IGZhbHNlIH0sXG4gICAgICB7IG5hbWU6ICdpc1VwbG9hZGVkJywgY29sdW1uOiAnaXNfdXBsb2FkZWQnLCB0eXBlOiAnYm9vbGVhbicsIG51bGw6IGZhbHNlIH0sXG4gICAgICB7IG5hbWU6ICdpc1N0b3JlZCcsIGNvbHVtbjogJ2lzX3N0b3JlZCcsIHR5cGU6ICdib29sZWFuJywgbnVsbDogZmFsc2UgfSxcbiAgICAgIHsgbmFtZTogJ2lzUHJvY2Vzc2VkJywgY29sdW1uOiAnaXNfcHJvY2Vzc2VkJywgdHlwZTogJ2Jvb2xlYW4nLCBudWxsOiBmYWxzZSB9LFxuICAgICAgeyBuYW1lOiAnbGF0aXR1ZGUnLCBjb2x1bW46ICdsYXRpdHVkZScsIHR5cGU6ICdkb3VibGUnIH0sXG4gICAgICB7IG5hbWU6ICdsb25naXR1ZGUnLCBjb2x1bW46ICdsb25naXR1ZGUnLCB0eXBlOiAnZG91YmxlJyB9LFxuICAgICAgeyBuYW1lOiAnZm9ybVJvd0lEJywgY29sdW1uOiAnZm9ybV9pZCcsIHR5cGU6ICdpbnRlZ2VyJyB9LFxuICAgICAgeyBuYW1lOiAnZm9ybUlEJywgY29sdW1uOiAnZm9ybV9yZXNvdXJjZV9pZCcsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB7IG5hbWU6ICdyZWNvcmRSb3dJRCcsIGNvbHVtbjogJ3JlY29yZF9pZCcsIHR5cGU6ICdpbnRlZ2VyJyB9LFxuICAgICAgeyBuYW1lOiAncmVjb3JkSUQnLCBjb2x1bW46ICdyZWNvcmRfcmVzb3VyY2VfaWQnLCB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgeyBuYW1lOiAndXBkYXRlZEJ5Um93SUQnLCBjb2x1bW46ICd1cGRhdGVkX2J5X2lkJywgdHlwZTogJ2ludGVnZXInIH0sXG4gICAgICB7IG5hbWU6ICd1cGRhdGVkQnlJRCcsIGNvbHVtbjogJ3VwZGF0ZWRfYnlfcmVzb3VyY2VfaWQnLCB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgeyBuYW1lOiAnY3JlYXRlZEJ5Um93SUQnLCBjb2x1bW46ICdjcmVhdGVkX2J5X2lkJywgdHlwZTogJ2ludGVnZXInIH0sXG4gICAgICB7IG5hbWU6ICdjcmVhdGVkQnlJRCcsIGNvbHVtbjogJ2NyZWF0ZWRfYnlfcmVzb3VyY2VfaWQnLCB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgeyBuYW1lOiAnYWx0aXR1ZGUnLCBjb2x1bW46ICdhbHRpdHVkZScsIHR5cGU6ICdkb3VibGUnIH0sXG4gICAgICB7IG5hbWU6ICdhY2N1cmFjeScsIGNvbHVtbjogJ2FjY3VyYWN5JywgdHlwZTogJ2RvdWJsZScgfSxcbiAgICAgIHsgbmFtZTogJ2RpcmVjdGlvbicsIGNvbHVtbjogJ2RpcmVjdGlvbicsIHR5cGU6ICdkb3VibGUnIH0sXG4gICAgICB7IG5hbWU6ICd3aWR0aCcsIGNvbHVtbjogJ3dpZHRoJywgdHlwZTogJ2ludGVnZXInIH0sXG4gICAgICB7IG5hbWU6ICdoZWlnaHQnLCBjb2x1bW46ICdoZWlnaHQnLCB0eXBlOiAnaW50ZWdlcicgfSxcbiAgICAgIHsgbmFtZTogJ21ha2UnLCBjb2x1bW46ICdtYWtlJywgdHlwZTogJ3N0cmluZycgfSxcbiAgICAgIHsgbmFtZTogJ21vZGVsJywgY29sdW1uOiAnbW9kZWwnLCB0eXBlOiAnc3RyaW5nJyB9LFxuICAgICAgeyBuYW1lOiAnc29mdHdhcmUnLCBjb2x1bW46ICdzb2Z0d2FyZScsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB7IG5hbWU6ICdkYXRlVGltZScsIGNvbHVtbjogJ2RhdGVfdGltZScsIHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICB7IG5hbWU6ICdjcmVhdGVkQXQnLCBjb2x1bW46ICdzZXJ2ZXJfY3JlYXRlZF9hdCcsIHR5cGU6ICdkYXRldGltZScgfSxcbiAgICAgIHsgbmFtZTogJ3VwZGF0ZWRBdCcsIGNvbHVtbjogJ3NlcnZlcl91cGRhdGVkX2F0JywgdHlwZTogJ2RhdGV0aW1lJyB9XG4gICAgXTtcbiAgfVxuXG4gIGdldCBpZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faWQ7XG4gIH1cblxuICBpbnRlZ2VyVmFsdWUodmFsdWUpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZVswXSA6IHZhbHVlO1xuICB9XG5cbiAgdXBkYXRlRnJvbUFQSUF0dHJpYnV0ZXMoYXR0cmlidXRlcykge1xuICAgIHRoaXMuX2lkID0gYXR0cmlidXRlcy5hY2Nlc3Nfa2V5O1xuICAgIHRoaXMuX2V4aWYgPSBhdHRyaWJ1dGVzLmV4aWY7XG4gICAgdGhpcy5fZmlsZVNpemUgPSBhdHRyaWJ1dGVzLmZpbGVfc2l6ZTtcbiAgICB0aGlzLl9sYXRpdHVkZSA9IGF0dHJpYnV0ZXMubGF0aXR1ZGU7XG4gICAgdGhpcy5fbG9uZ2l0dWRlID0gYXR0cmlidXRlcy5sb25naXR1ZGU7XG4gICAgdGhpcy5faXNVcGxvYWRlZCA9IGF0dHJpYnV0ZXMudXBsb2FkZWQ7XG4gICAgdGhpcy5faXNTdG9yZWQgPSBhdHRyaWJ1dGVzLnN0b3JlZDtcbiAgICB0aGlzLl9pc1Byb2Nlc3NlZCA9IGF0dHJpYnV0ZXMucHJvY2Vzc2VkO1xuICAgIHRoaXMuX2NvbnRlbnRUeXBlID0gYXR0cmlidXRlcy5jb250ZW50X3R5cGU7XG4gICAgdGhpcy5fY3JlYXRlZEJ5SUQgPSBhdHRyaWJ1dGVzLmNyZWF0ZWRfYnlfaWQ7XG4gICAgdGhpcy5fdXBkYXRlZEJ5SUQgPSBhdHRyaWJ1dGVzLnVwZGF0ZWRfYnlfaWQ7XG4gICAgdGhpcy5fY3JlYXRlZEF0ID0gRGF0ZVV0aWxzLnBhcnNlSVNPVGltZXN0YW1wKGF0dHJpYnV0ZXMuY3JlYXRlZF9hdCk7XG4gICAgdGhpcy5fdXBkYXRlZEF0ID0gRGF0ZVV0aWxzLnBhcnNlSVNPVGltZXN0YW1wKGF0dHJpYnV0ZXMudXBkYXRlZF9hdCk7XG4gICAgdGhpcy5fZm9ybUlEID0gYXR0cmlidXRlcy5mb3JtX2lkO1xuICAgIHRoaXMuX3JlY29yZElEID0gYXR0cmlidXRlcy5yZWNvcmRfaWQ7XG5cbiAgICBpZiAoYXR0cmlidXRlcy5leGlmKSB7XG4gICAgICBjb25zdCB7ZXhpZn0gPSBhdHRyaWJ1dGVzO1xuXG4gICAgICB0aGlzLl9hbHRpdHVkZSA9IGV4aWYuZ3BzX2FsdGl0dWRlO1xuICAgICAgdGhpcy5fZGlyZWN0aW9uID0gZXhpZi5ncHNfaW1nX2RpcmVjdGlvbjtcbiAgICAgIHRoaXMuX2FjY3VyYWN5ID0gZXhpZi5ncHNfZG9wO1xuICAgICAgdGhpcy5fd2lkdGggPSB0aGlzLmludGVnZXJWYWx1ZShleGlmLnBpeGVsX3hfZGltZW5zaW9uKTtcbiAgICAgIHRoaXMuX2hlaWdodCA9IHRoaXMuaW50ZWdlclZhbHVlKGV4aWYucGl4ZWxfeV9kaW1lbnNpb24pO1xuICAgICAgdGhpcy5fbWFrZSA9IGV4aWYubWFrZTtcbiAgICAgIHRoaXMuX21vZGVsID0gZXhpZi5tb2RlbDtcbiAgICAgIHRoaXMuX3NvZnR3YXJlID0gZXhpZi5zb2Z0d2FyZTtcbiAgICAgIHRoaXMuX2RhdGVUaW1lID0gZXhpZi5kYXRlX3RpbWVfb3JpZ2luYWwgfHwgZXhpZi5kYXRlX3RpbWU7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGlzRG93bmxvYWRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNEb3dubG9hZGVkO1xuICB9XG5cbiAgc2V0IGlzRG93bmxvYWRlZCh2YWx1ZSkge1xuICAgIHRoaXMuX2lzRG93bmxvYWRlZCA9ICEhdmFsdWU7XG4gIH1cblxuICBnZXQgY3JlYXRlZEF0KCkge1xuICAgIHJldHVybiB0aGlzLl9jcmVhdGVkQXQ7XG4gIH1cblxuICBnZXQgdXBkYXRlZEF0KCkge1xuICAgIHJldHVybiB0aGlzLl91cGRhdGVkQXQ7XG4gIH1cbn1cblxuUGVyc2lzdGVudE9iamVjdC5yZWdpc3RlcihQaG90byk7XG4iXX0=