"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _client = _interopRequireDefault(require("../../api/client"));

var _membership = _interopRequireDefault(require("../../models/membership"));

var _downloadResource = _interopRequireDefault(require("./download-resource"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class DownloadMemberships extends _downloadResource.default {
  get resourceName() {
    return 'memberships';
  }

  get typeName() {
    return 'membership';
  }

  fetchObjects(lastSync, sequence) {
    return _client.default.getMemberships(this.account);
  }

  fetchLocalObjects() {
    return this.account.findMemberships();
  }

  findOrCreate(database, attributes) {
    return _membership.default.findOrCreate(database, {
      user_resource_id: attributes.user_id,
      account_id: this.account.rowID
    });
  }

  async loadObject(object, attributes) {
    await object.getLocalRole();
  }

}

exports.default = DownloadMemberships;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9tYWluL3N5bmMvdGFza3MvZG93bmxvYWQtbWVtYmVyc2hpcHMuanMiXSwibmFtZXMiOlsiRG93bmxvYWRNZW1iZXJzaGlwcyIsIkRvd25sb2FkUmVzb3VyY2UiLCJyZXNvdXJjZU5hbWUiLCJ0eXBlTmFtZSIsImZldGNoT2JqZWN0cyIsImxhc3RTeW5jIiwic2VxdWVuY2UiLCJDbGllbnQiLCJnZXRNZW1iZXJzaGlwcyIsImFjY291bnQiLCJmZXRjaExvY2FsT2JqZWN0cyIsImZpbmRNZW1iZXJzaGlwcyIsImZpbmRPckNyZWF0ZSIsImRhdGFiYXNlIiwiYXR0cmlidXRlcyIsIk1lbWJlcnNoaXAiLCJ1c2VyX3Jlc291cmNlX2lkIiwidXNlcl9pZCIsImFjY291bnRfaWQiLCJyb3dJRCIsImxvYWRPYmplY3QiLCJvYmplY3QiLCJnZXRMb2NhbFJvbGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7OztBQUVlLE1BQU1BLG1CQUFOLFNBQWtDQyx5QkFBbEMsQ0FBbUQ7QUFDaEQsTUFBWkMsWUFBWSxHQUFHO0FBQ2pCLFdBQU8sYUFBUDtBQUNEOztBQUVXLE1BQVJDLFFBQVEsR0FBRztBQUNiLFdBQU8sWUFBUDtBQUNEOztBQUVEQyxFQUFBQSxZQUFZLENBQUNDLFFBQUQsRUFBV0MsUUFBWCxFQUFxQjtBQUMvQixXQUFPQyxnQkFBT0MsY0FBUCxDQUFzQixLQUFLQyxPQUEzQixDQUFQO0FBQ0Q7O0FBRURDLEVBQUFBLGlCQUFpQixHQUFHO0FBQ2xCLFdBQU8sS0FBS0QsT0FBTCxDQUFhRSxlQUFiLEVBQVA7QUFDRDs7QUFFREMsRUFBQUEsWUFBWSxDQUFDQyxRQUFELEVBQVdDLFVBQVgsRUFBdUI7QUFDakMsV0FBT0Msb0JBQVdILFlBQVgsQ0FBd0JDLFFBQXhCLEVBQWtDO0FBQUNHLE1BQUFBLGdCQUFnQixFQUFFRixVQUFVLENBQUNHLE9BQTlCO0FBQXVDQyxNQUFBQSxVQUFVLEVBQUUsS0FBS1QsT0FBTCxDQUFhVTtBQUFoRSxLQUFsQyxDQUFQO0FBQ0Q7O0FBRWUsUUFBVkMsVUFBVSxDQUFDQyxNQUFELEVBQVNQLFVBQVQsRUFBcUI7QUFDbkMsVUFBTU8sTUFBTSxDQUFDQyxZQUFQLEVBQU47QUFDRDs7QUF2QitEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENsaWVudCBmcm9tICcuLi8uLi9hcGkvY2xpZW50JztcbmltcG9ydCBNZW1iZXJzaGlwIGZyb20gJy4uLy4uL21vZGVscy9tZW1iZXJzaGlwJztcbmltcG9ydCBEb3dubG9hZFJlc291cmNlIGZyb20gJy4vZG93bmxvYWQtcmVzb3VyY2UnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEb3dubG9hZE1lbWJlcnNoaXBzIGV4dGVuZHMgRG93bmxvYWRSZXNvdXJjZSB7XG4gIGdldCByZXNvdXJjZU5hbWUoKSB7XG4gICAgcmV0dXJuICdtZW1iZXJzaGlwcyc7XG4gIH1cblxuICBnZXQgdHlwZU5hbWUoKSB7XG4gICAgcmV0dXJuICdtZW1iZXJzaGlwJztcbiAgfVxuXG4gIGZldGNoT2JqZWN0cyhsYXN0U3luYywgc2VxdWVuY2UpIHtcbiAgICByZXR1cm4gQ2xpZW50LmdldE1lbWJlcnNoaXBzKHRoaXMuYWNjb3VudCk7XG4gIH1cblxuICBmZXRjaExvY2FsT2JqZWN0cygpIHtcbiAgICByZXR1cm4gdGhpcy5hY2NvdW50LmZpbmRNZW1iZXJzaGlwcygpO1xuICB9XG5cbiAgZmluZE9yQ3JlYXRlKGRhdGFiYXNlLCBhdHRyaWJ1dGVzKSB7XG4gICAgcmV0dXJuIE1lbWJlcnNoaXAuZmluZE9yQ3JlYXRlKGRhdGFiYXNlLCB7dXNlcl9yZXNvdXJjZV9pZDogYXR0cmlidXRlcy51c2VyX2lkLCBhY2NvdW50X2lkOiB0aGlzLmFjY291bnQucm93SUR9KTtcbiAgfVxuXG4gIGFzeW5jIGxvYWRPYmplY3Qob2JqZWN0LCBhdHRyaWJ1dGVzKSB7XG4gICAgYXdhaXQgb2JqZWN0LmdldExvY2FsUm9sZSgpO1xuICB9XG59XG4iXX0=