"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = execute;

var _child_process = require("child_process");

function execute(command, options = {}, logPrefix = 'execute') {
  if (options == null) {
    options = {};
  }

  const env = { ...process.env,
    ...options.env,
    ELECTRON_RUN_AS_NODE: 1
  };
  return new Promise((resolve, reject) => {
    try {
      const child = (0, _child_process.exec)(command, { ...options,
        env
      });

      const stdoutWrite = data => {
        process.stdout.write(logPrefix.green + ' ' + data.toString());
      };

      const stderrWrite = data => {
        process.stderr.write(logPrefix.red + ' ' + data.toString());
      };

      stdoutWrite(command + '\n');
      child.stdout.on('data', stdoutWrite);
      child.stderr.on('data', stderrWrite);
      child.on('exit', resolve);
    } catch (ex) {
      reject(ex);
    }
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9tYWluL3V0aWxzL2V4ZWMuanMiXSwibmFtZXMiOlsiZXhlY3V0ZSIsImNvbW1hbmQiLCJvcHRpb25zIiwibG9nUHJlZml4IiwiZW52IiwicHJvY2VzcyIsIkVMRUNUUk9OX1JVTl9BU19OT0RFIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjaGlsZCIsInN0ZG91dFdyaXRlIiwiZGF0YSIsInN0ZG91dCIsIndyaXRlIiwiZ3JlZW4iLCJ0b1N0cmluZyIsInN0ZGVycldyaXRlIiwic3RkZXJyIiwicmVkIiwib24iLCJleCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVlLFNBQVNBLE9BQVQsQ0FBaUJDLE9BQWpCLEVBQTBCQyxPQUFPLEdBQUcsRUFBcEMsRUFBd0NDLFNBQVMsR0FBRyxTQUFwRCxFQUErRDtBQUM1RSxNQUFJRCxPQUFPLElBQUksSUFBZixFQUFxQjtBQUNuQkEsSUFBQUEsT0FBTyxHQUFHLEVBQVY7QUFDRDs7QUFFRCxRQUFNRSxHQUFHLEdBQUcsRUFDVixHQUFHQyxPQUFPLENBQUNELEdBREQ7QUFFVixPQUFHRixPQUFPLENBQUNFLEdBRkQ7QUFHVkUsSUFBQUEsb0JBQW9CLEVBQUU7QUFIWixHQUFaO0FBTUEsU0FBTyxJQUFJQyxPQUFKLENBQVksQ0FBQ0MsT0FBRCxFQUFVQyxNQUFWLEtBQXFCO0FBQ3RDLFFBQUk7QUFDRixZQUFNQyxLQUFLLEdBQUcseUJBQUtULE9BQUwsRUFBYyxFQUFDLEdBQUdDLE9BQUo7QUFBYUUsUUFBQUE7QUFBYixPQUFkLENBQWQ7O0FBRUEsWUFBTU8sV0FBVyxHQUFJQyxJQUFELElBQVU7QUFDNUJQLFFBQUFBLE9BQU8sQ0FBQ1EsTUFBUixDQUFlQyxLQUFmLENBQXFCWCxTQUFTLENBQUNZLEtBQVYsR0FBa0IsR0FBbEIsR0FBd0JILElBQUksQ0FBQ0ksUUFBTCxFQUE3QztBQUNELE9BRkQ7O0FBSUEsWUFBTUMsV0FBVyxHQUFJTCxJQUFELElBQVU7QUFDNUJQLFFBQUFBLE9BQU8sQ0FBQ2EsTUFBUixDQUFlSixLQUFmLENBQXFCWCxTQUFTLENBQUNnQixHQUFWLEdBQWdCLEdBQWhCLEdBQXNCUCxJQUFJLENBQUNJLFFBQUwsRUFBM0M7QUFDRCxPQUZEOztBQUlBTCxNQUFBQSxXQUFXLENBQUNWLE9BQU8sR0FBRyxJQUFYLENBQVg7QUFFQVMsTUFBQUEsS0FBSyxDQUFDRyxNQUFOLENBQWFPLEVBQWIsQ0FBZ0IsTUFBaEIsRUFBd0JULFdBQXhCO0FBQ0FELE1BQUFBLEtBQUssQ0FBQ1EsTUFBTixDQUFhRSxFQUFiLENBQWdCLE1BQWhCLEVBQXdCSCxXQUF4QjtBQUVBUCxNQUFBQSxLQUFLLENBQUNVLEVBQU4sQ0FBUyxNQUFULEVBQWlCWixPQUFqQjtBQUNELEtBakJELENBaUJFLE9BQU9hLEVBQVAsRUFBVztBQUNYWixNQUFBQSxNQUFNLENBQUNZLEVBQUQsQ0FBTjtBQUNEO0FBQ0YsR0FyQk0sQ0FBUDtBQXNCRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7ZXhlY30gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGV4ZWN1dGUoY29tbWFuZCwgb3B0aW9ucyA9IHt9LCBsb2dQcmVmaXggPSAnZXhlY3V0ZScpIHtcbiAgaWYgKG9wdGlvbnMgPT0gbnVsbCkge1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuXG4gIGNvbnN0IGVudiA9IHtcbiAgICAuLi5wcm9jZXNzLmVudixcbiAgICAuLi5vcHRpb25zLmVudixcbiAgICBFTEVDVFJPTl9SVU5fQVNfTk9ERTogMVxuICB9O1xuXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNoaWxkID0gZXhlYyhjb21tYW5kLCB7Li4ub3B0aW9ucywgZW52fSk7XG5cbiAgICAgIGNvbnN0IHN0ZG91dFdyaXRlID0gKGRhdGEpID0+IHtcbiAgICAgICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUobG9nUHJlZml4LmdyZWVuICsgJyAnICsgZGF0YS50b1N0cmluZygpKTtcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHN0ZGVycldyaXRlID0gKGRhdGEpID0+IHtcbiAgICAgICAgcHJvY2Vzcy5zdGRlcnIud3JpdGUobG9nUHJlZml4LnJlZCArICcgJyArIGRhdGEudG9TdHJpbmcoKSk7XG4gICAgICB9O1xuXG4gICAgICBzdGRvdXRXcml0ZShjb21tYW5kICsgJ1xcbicpO1xuXG4gICAgICBjaGlsZC5zdGRvdXQub24oJ2RhdGEnLCBzdGRvdXRXcml0ZSk7XG4gICAgICBjaGlsZC5zdGRlcnIub24oJ2RhdGEnLCBzdGRlcnJXcml0ZSk7XG5cbiAgICAgIGNoaWxkLm9uKCdleGl0JywgcmVzb2x2ZSk7XG4gICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgIHJlamVjdChleCk7XG4gICAgfVxuICB9KTtcbn1cbiJdfQ==