"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _client = _interopRequireDefault(require("../../api/client"));

var _membership = _interopRequireDefault(require("../../models/membership"));

var _downloadResource = _interopRequireDefault(require("./download-resource"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class DownloadMemberships extends _downloadResource.default {
  get resourceName() {
    return 'memberships';
  }

  get typeName() {
    return 'membership';
  }

  fetchObjects(lastSync, sequence) {
    return _client.default.getMemberships(this.account);
  }

  fetchLocalObjects() {
    return this.account.findMemberships();
  }

  findOrCreate(database, attributes) {
    return _membership.default.findOrCreate(database, {
      user_resource_id: attributes.user_id,
      account_id: this.account.rowID
    });
  }

  async loadObject(object, attributes) {
    await object.getLocalRole();
  }

}

exports.default = DownloadMemberships;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zeW5jL3Rhc2tzL2Rvd25sb2FkLW1lbWJlcnNoaXBzLmpzIl0sIm5hbWVzIjpbIkRvd25sb2FkTWVtYmVyc2hpcHMiLCJEb3dubG9hZFJlc291cmNlIiwicmVzb3VyY2VOYW1lIiwidHlwZU5hbWUiLCJmZXRjaE9iamVjdHMiLCJsYXN0U3luYyIsInNlcXVlbmNlIiwiQ2xpZW50IiwiZ2V0TWVtYmVyc2hpcHMiLCJhY2NvdW50IiwiZmV0Y2hMb2NhbE9iamVjdHMiLCJmaW5kTWVtYmVyc2hpcHMiLCJmaW5kT3JDcmVhdGUiLCJkYXRhYmFzZSIsImF0dHJpYnV0ZXMiLCJNZW1iZXJzaGlwIiwidXNlcl9yZXNvdXJjZV9pZCIsInVzZXJfaWQiLCJhY2NvdW50X2lkIiwicm93SUQiLCJsb2FkT2JqZWN0Iiwib2JqZWN0IiwiZ2V0TG9jYWxSb2xlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7Ozs7QUFFZSxNQUFNQSxtQkFBTixTQUFrQ0MseUJBQWxDLENBQW1EO0FBQ2hELE1BQVpDLFlBQVksR0FBRztBQUNqQixXQUFPLGFBQVA7QUFDRDs7QUFFVyxNQUFSQyxRQUFRLEdBQUc7QUFDYixXQUFPLFlBQVA7QUFDRDs7QUFFREMsRUFBQUEsWUFBWSxDQUFDQyxRQUFELEVBQVdDLFFBQVgsRUFBcUI7QUFDL0IsV0FBT0MsZ0JBQU9DLGNBQVAsQ0FBc0IsS0FBS0MsT0FBM0IsQ0FBUDtBQUNEOztBQUVEQyxFQUFBQSxpQkFBaUIsR0FBRztBQUNsQixXQUFPLEtBQUtELE9BQUwsQ0FBYUUsZUFBYixFQUFQO0FBQ0Q7O0FBRURDLEVBQUFBLFlBQVksQ0FBQ0MsUUFBRCxFQUFXQyxVQUFYLEVBQXVCO0FBQ2pDLFdBQU9DLG9CQUFXSCxZQUFYLENBQXdCQyxRQUF4QixFQUFrQztBQUFDRyxNQUFBQSxnQkFBZ0IsRUFBRUYsVUFBVSxDQUFDRyxPQUE5QjtBQUF1Q0MsTUFBQUEsVUFBVSxFQUFFLEtBQUtULE9BQUwsQ0FBYVU7QUFBaEUsS0FBbEMsQ0FBUDtBQUNEOztBQUVlLFFBQVZDLFVBQVUsQ0FBQ0MsTUFBRCxFQUFTUCxVQUFULEVBQXFCO0FBQ25DLFVBQU1PLE1BQU0sQ0FBQ0MsWUFBUCxFQUFOO0FBQ0Q7O0FBdkIrRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDbGllbnQgZnJvbSAnLi4vLi4vYXBpL2NsaWVudCc7XG5pbXBvcnQgTWVtYmVyc2hpcCBmcm9tICcuLi8uLi9tb2RlbHMvbWVtYmVyc2hpcCc7XG5pbXBvcnQgRG93bmxvYWRSZXNvdXJjZSBmcm9tICcuL2Rvd25sb2FkLXJlc291cmNlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRG93bmxvYWRNZW1iZXJzaGlwcyBleHRlbmRzIERvd25sb2FkUmVzb3VyY2Uge1xuICBnZXQgcmVzb3VyY2VOYW1lKCkge1xuICAgIHJldHVybiAnbWVtYmVyc2hpcHMnO1xuICB9XG5cbiAgZ2V0IHR5cGVOYW1lKCkge1xuICAgIHJldHVybiAnbWVtYmVyc2hpcCc7XG4gIH1cblxuICBmZXRjaE9iamVjdHMobGFzdFN5bmMsIHNlcXVlbmNlKSB7XG4gICAgcmV0dXJuIENsaWVudC5nZXRNZW1iZXJzaGlwcyh0aGlzLmFjY291bnQpO1xuICB9XG5cbiAgZmV0Y2hMb2NhbE9iamVjdHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuYWNjb3VudC5maW5kTWVtYmVyc2hpcHMoKTtcbiAgfVxuXG4gIGZpbmRPckNyZWF0ZShkYXRhYmFzZSwgYXR0cmlidXRlcykge1xuICAgIHJldHVybiBNZW1iZXJzaGlwLmZpbmRPckNyZWF0ZShkYXRhYmFzZSwge3VzZXJfcmVzb3VyY2VfaWQ6IGF0dHJpYnV0ZXMudXNlcl9pZCwgYWNjb3VudF9pZDogdGhpcy5hY2NvdW50LnJvd0lEfSk7XG4gIH1cblxuICBhc3luYyBsb2FkT2JqZWN0KG9iamVjdCwgYXR0cmlidXRlcykge1xuICAgIGF3YWl0IG9iamVjdC5nZXRMb2NhbFJvbGUoKTtcbiAgfVxufVxuIl19